<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Calculadora de Peso</title>

    <script src="./js/sessao.js"></script>

    <link rel="stylesheet" href="css/calculadoraPeso.css">
    <link rel="icon" href="img/S4L.png">
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>

<body>

    <header>
        <img class="logo" src="img/S4L.png" alt="">
        <nav class="nav-bar">
            <ul>
                <a class="links" href="#sessaoSobre">
                    <li>Sobre a calculadora</li>
                </a>
                <a class="links" href="#sessaoCalcular">
                    <li>Calcular</li>
                </a>
                <a class="links" href="#rodape">
                    <li>Contato</li>
                </a>
            </ul>
            <ul>
                <a class="links" href="cadastro.html">
                    <li class="cadastroLogin">Cadastro</li>
                </a>
                <a class="links" href="login.html">
                    <li class="cadastroLogin">Login</li>
                </a>
            </ul>
        </nav>
    </header>
    <section id="sessaoSobre" class="containerSobre">
        <img class="svg" src="img/img.svg" alt="">
        <p class="sobreCalc">A calculadora da S4L permite que você faça cálculos de seu peso<br> e trará informações de
            como você poderá diminuir seu peso usando o skate para isso.<br>
            Além disso permitirá que você informe sua meta de peso e seu peso atual para que você possa acompanhar sua
            evolução.<br>
            Para nós é de extrema importância que você defina uma meta, por que sabemos que quando temos objetivos
            concretos,<br> criamos força de vontade para continuar mesmo que seja difícil.<br>
            Então por isso temos uma calculadora de peso que grava o peso do usuário,<br> define metas e exibe essas
            informações em um gráfico.<br> É uma ferramenta poderosa para qualquer pessoa comprometida com a perda de
            peso<br> ou a manutenção de um peso saudável. Ao fornecer uma maneira visual e interativa de acompanhar o
            progresso,<br>essa ferramenta pode transformar a jornada de saúde, tornando-a mais organizada e motivadora.
        </p>
    </section>

    <section id="sessaoCalcular">
        <h2 class="h2Oopcao">Calcular perda de peso</h2>
        <div class="cardOpcao">
            <div class="card">
                <h1 class="tituloInput1">Altura</h1>
                <input class="inputs" type="text" id="inputAltura" placeholder="exemplo: 1.89">
                <h1 class="tituloInput2">Peso atual</h1>
                <input class="inputs" type="text" id="inputPeso" placeholder="exemplo: 59.90">
                <h1 class="tituloInput3">Meta de peso</h1>
                <input class="inputs" type="text" id="inputMetaPeso" placeholder="exemplo: 59.90">
                <h1 class="tituloPerda4">Horas andadas de skate</h1>
                <input class="inputs" type="text" id="inputHorasSkate" placeholder="exemplo: 4"><br><br>
                <button class="btnCalcular" onclick="calcularPeso()">Calcular Peso</button>
            </div>
            <div id="card">
                <a class="linkDash" href="dashboard/dashboard.html">
                    <p>Ver métricas</p>
                </a>
            </div>
        </div>
    </section>

    <section class="sessao-rodape" id="rodape">
        <div class="cardFooter">
            <a href="https://api.whatsapp.com/send/?phone=5511942170850&text&type=phone_number&app_absent=0"><img
                    src="img/chamada-telefonica.png" alt=""></a>
            <h1 class="tituloFooter">Telefone</h1>
            <p class="subtituloFooter">(11) 942170850</p>
        </div>
        <div class="cardFooter">
            <a href="mailto:pedro.tsouza@sptech.school"><img src="img/o-email.png" alt=""></a>
            <h1 class="tituloFooter">E-mail</h1>
            <p class="subtituloFooter">pedro.tsouza@sptech.school</p>
        </div>
        <div class="cardFooter">
            <a href="https://www.linkedin.com/in/pedro-trovo-4189a7215/"><img src="img/linkedin.png" alt=""></a>
            <h1 class="tituloFooter">LinkedIn</h1>
            <p class="subtituloFooter">@PedroTrovo</p>
        </div>
        <div class="cardFooter">
            <a href="https://github.com/TrovoPedro"><img src="img/github.png" alt=""></a>
            <h1 class="tituloFooter">Github</h1>
            <p class="subtituloFooter">@TrovoPedro</p>
        </div>
    </section>


</body>

</html>

<script>

    function calcularPeso() {
        var altura = Number(inputAltura.value);
        var pesoAtual = Number(inputPeso.value);
        var qtdHoras = Number(inputHorasSkate.value);
        var metaPeso = Number(inputMetaPeso.value);
        var caloriasPH = 500;
        var resultadoCaloriasAndadas = qtdHoras * caloriasPH;
        var pesoGramas = pesoAtual * 1000;
        var pesoCalorias = 7700 * pesoGramas;
        var pesoMMeta = pesoAtual - metaPeso;

        if (inputAltura.value == "" || inputPeso.value == "" || inputHorasSkate.value == "" || inputMetaPeso.value == "") {
            alert("Por favor, preecha todos os campos");
        } else {
            var resultadoImc = pesoAtual / (altura * altura);
            if (resultadoImc <= 18.5) {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, você está abaixo do peso.`;
            } else if (resultadoImc >= 18.6 && resultadoImc <= 24.9) {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, parabéns, você está no peso ideal.`;
            } else if (resultadoImc >= 25 && resultadoImc <= 29.99) {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, você está sobrepeso e pode ser prejudicial a saúde. <br>`;
            } else if (resultadoImc >= 30 && resultadoImc <= 34.9) {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, CUIDADO, você está na obesidade grau 1 e é prejudicial a saúde. <br>`;
            } else if (resultadoImc >= 35 && resultadoImc <= 39.99) {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, CUIDADO, você está na obesidade grau 2 e é muito prejudicial a saúde. <br>`;
            } else {
                card.innerHTML = `Seu imc é de ${resultadoImc.toFixed(2)}, CUIDADO, você está na obesidade grau 2 e é extremamente prejudicial a saúde. <br>`;
            }

            if (resultadoCaloriasAndadas <= 7700) {
                var pesoAG = pesoGramas / 1000; //peso atual em gramas
                var pesoMostrar = 7700 - resultadoCaloriasAndadas;
                pesoAtual = pesoAG - (resultadoCaloriasAndadas / 1000);

                card.innerHTML += `Andando de skate por ${qtdHoras} horas, você perdeu ${resultadoCaloriasAndadas} calorias. <br>
                Faltam ${pesoMostrar} calorias para perder 1kg. <br> Peso atual: ${pesoAtual.toFixed(2)}. <br>
                Faltam ${pesoMMeta.toFixed(2)} quilos para bater sua meta.`;
            } else {
                var pesoAG = pesoGramas / 1000;
                pesoAtual = pesoAG - (resultadoCaloriasAndadas / 1000);

                card.innerHTML += `Andando de skate por ${qtdHoras} horas, você perdeu ${resultadoCaloriasAndadas}. <br>
                Peso atual: ${pesoAtual.toFixed(2)}. <br>
                Faltam ${pesoMMeta.toFixed(2)} quilos para bater sua meta.`;
            }

            fetch("/estatistica/cadastrarEstatistica", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js
                    PesoServer: pesoAtual,
                    qtdHorasServer: qtdHoras,
                    metaPesoServer: metaPeso
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {
                        cardErro.style.display = "block";

                        mensagem_erro.innerHTML =
                            "Informações gravadas com sucesso";

                        setTimeout(() => {
                            window.location = "dashboard/dashboard.html";
                        }, "2000");

                        limparFormulario();
                        finalizarAguardar();
                    } else {
                        throw "Houve um erro ao tentar gravar as informações";
                    }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                    finalizarAguardar();
                });

            return false;
        }
    }
</script>